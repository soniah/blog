<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Dns on Sonia Hamilton - Blog</title>
    <link>http://blog2.snowfrog.net/tags/dns/</link>
    <description>Recent content in Dns on Sonia Hamilton - Blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <lastBuildDate>Sat, 07 Jul 2012 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://blog2.snowfrog.net/tags/dns/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>vnc ssh tunnel for remote graphical support</title>
      <link>http://blog2.snowfrog.net/2012/07/07/vnc-ssh-tunnel-for-remote-graphical-support/</link>
      <pubDate>Sat, 07 Jul 2012 00:00:00 +0000</pubDate>
      
      <guid>http://blog2.snowfrog.net/2012/07/07/vnc-ssh-tunnel-for-remote-graphical-support/</guid>
      <description>&lt;p&gt;I was doing remote internet support the other day for a friend in England - here&amp;rsquo;s how I connect remotely to the person&amp;rsquo;s desktop in graphical mode, using vnc and an ssh tunnel.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;I setup a dyndns client (eg dyndns, tinydyndns, ez-ipupdate) so I can connect to the changing ip address of their machine by a dns name eg fredbox.dyndns.org&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #202020&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span style=&#34;color: #24909d&#34;&gt;local&lt;/span&gt;% sudo apt-get install ez-ipupdate
&lt;/pre&gt;&lt;/div&gt;
&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;I copy my ssh key to their account - this way I&amp;rsquo;ll always have access and they can change their password in the future:&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #202020&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span style=&#34;color: #24909d&#34;&gt;local&lt;/span&gt;% ssh-copy-id fred@fredbox.dyndns.org
&lt;/pre&gt;&lt;/div&gt;
&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;I want to connect to vnc running on their desktop, so I can see what they see. But vnc runs on port 5900 and I don&amp;rsquo;t want to leave that open to the Internet. So I build an ssh tunnel, and startup vnc on the remote machine:&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #202020&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;fredbox% ssh -L 5900:localhost:5900 fred@fredbox.dyndns.org
fredbox% x11vnc -safer -usepw -localhost -once -noxdamage &lt;span style=&#34;color: #ed9d13&#34;&gt;\&lt;/span&gt;
         -nowf -ncache &lt;span style=&#34;color: #3677a9&#34;&gt;0&lt;/span&gt; -scale 2/3 -display :0
&lt;/pre&gt;&lt;/div&gt;
&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;And finally, I start up my vncviewer on my local Linux/Mac machine, and enter my vnc password when prompted:&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #202020&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span style=&#34;color: #24909d&#34;&gt;local&lt;/span&gt;% vncviewer -encodings &lt;span style=&#34;color: #ed9d13&#34;&gt;&amp;quot;copyrect tight zrle hextile&amp;quot;&lt;/span&gt; &lt;span style=&#34;color: #ed9d13&#34;&gt;\&lt;/span&gt;
  -bgr233 -compresslevel &lt;span style=&#34;color: #3677a9&#34;&gt;5&lt;/span&gt; localhost
&lt;/pre&gt;&lt;/div&gt;
&lt;/p&gt;

&lt;p&gt;So here&amp;rsquo;s a little script that brings it all together:&lt;/p&gt;

&lt;p&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #202020&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span style=&#34;color: #999999; font-style: italic&#34;&gt;#!/bin/bash&lt;/span&gt;
&lt;span style=&#34;color: #999999; font-style: italic&#34;&gt;# kill any previous/hung vnc&amp;#39;s&lt;/span&gt;
ssh fred@fredbox.dyndns.org &lt;span style=&#34;color: #ed9d13&#34;&gt;&amp;#39;pkill x11vnc&amp;#39;&lt;/span&gt;
ssh -f -L 5900:localhost:5900 fred@fredbox.dyndns.org &lt;span style=&#34;color: #ed9d13&#34;&gt;\&lt;/span&gt;
    &lt;span style=&#34;color: #ed9d13&#34;&gt;&amp;#39;x11vnc -safer -usepw -localhost -once -noxdamage \&lt;/span&gt;
&lt;span style=&#34;color: #ed9d13&#34;&gt;      -nowf -ncache 0 -scale 2/3 -display :0&amp;#39;&lt;/span&gt; &lt;span style=&#34;color: #ed9d13&#34;&gt;\&lt;/span&gt;
    &lt;span style=&#34;color: #d0d0d0&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; sleep &lt;span style=&#34;color: #3677a9&#34;&gt;5&lt;/span&gt; &lt;span style=&#34;color: #ed9d13&#34;&gt;\&lt;/span&gt;
    &lt;span style=&#34;color: #d0d0d0&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; vncviewer -encodings &lt;span style=&#34;color: #ed9d13&#34;&gt;&amp;quot;copyrect tight zrle hextile&amp;quot;&lt;/span&gt; &lt;span style=&#34;color: #ed9d13&#34;&gt;\&lt;/span&gt;
         -bgr233 -compresslevel &lt;span style=&#34;color: #3677a9&#34;&gt;5&lt;/span&gt; localhost
&lt;/pre&gt;&lt;/div&gt;
&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Ssh SOCKS proxying, DNS proxying, Tunnelling</title>
      <link>http://blog2.snowfrog.net/2008/06/12/ssh-socks-proxying-dns-proxying/</link>
      <pubDate>Thu, 12 Jun 2008 00:00:00 +0000</pubDate>
      
      <guid>http://blog2.snowfrog.net/2008/06/12/ssh-socks-proxying-dns-proxying/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;http://puzzling.org/&#34;&gt;Mary Gardiner&lt;/a&gt; &lt;a href=&#34;http://lists.slug.org.au/archives/slug/2008/06/msg00135.html&#34;&gt;answered&lt;/a&gt; one of Voytek Eymont&amp;rsquo;s questions on the &lt;a href=&#34;http://lists.slug.org.au/listinfo/slug&#34;&gt;SLUG list&lt;/a&gt; by referring to the &lt;a href=&#34;http://ubuntu.wordpress.com/2006/12/08/ssh-tunnel-socks-proxy-forwarding-secure-browsing/&#34;&gt;ssh socks proxying&lt;/a&gt; post on Ubuntu Blog.&lt;/p&gt;

&lt;p&gt;I was already familiar with ssh socks proxying, but that page has a good set of comments and links. A summary of that post, plus some other notes:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;setup via &lt;code&gt;$ssh -D 9999 username@ip-address-of-ssh-server&lt;/code&gt;, configure web browser **socks 5 host **(not http proxy) to localhost:9999 (On Firefox: Preferences, Advanced, Network, Settings, Manual, SOCKS Host. &lt;a href=&#34;http://foxyproxy.mozdev.org/&#34;&gt;FoxyProxy&lt;/a&gt; really helps with this &amp;ndash; you can setup wildcards to send certain URLs via certain proxies eg for when connecting via a VPN to work)&lt;/li&gt;
&lt;li&gt;http proxying can be setup at the command line (for use by wget, apt, etc) with the &lt;strong&gt;http_proxy&lt;/strong&gt; environment variable. For example &lt;em&gt;export http_proxy=&amp;lsquo;&lt;a href=&#34;http://user:password@1.2.3.4:3128/&#39;&#34;&gt;http://user:password@1.2.3.4:3128/&#39;&lt;/a&gt;; cmd1; cmd2; export http_proxy=&amp;rdquo;&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;configure apt to use a proxy via &lt;strong&gt;/etc/apt/apt.conf&lt;/strong&gt; by using &lt;strong&gt;Acquire::http::Proxy &amp;ldquo;&lt;a href=&#34;http://username:password@proxyserver:port/&amp;quot;&#34;&gt;http://username:password@proxyserver:port/&amp;quot;&lt;/a&gt;;&lt;/strong&gt; See &lt;a href=&#34;http://blogs.oracle.com/avinashjoshi/entry/using_apt_get_behind_a&#34;&gt;Using apt-get behind a proxy&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;there&amp;rsquo;s also &lt;a href=&#34;http://www.mtu.net/~engstrom/ssh-proxy.php&#34;&gt;corkscrew&lt;/a&gt; (preferred), connect.c, and &lt;a href=&#34;http://proxychains.sourceforge.net/&#34;&gt;proxychains&lt;/a&gt; to secure other traffic or setup tunnels automagically in ~/.ssh/config. For example:&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;% sudo aptitude install corkscrew

% cat ~/.ssh/config
Host foo.bar.com
    User me
    Port 443
    ProxyCommand corkscrew 1.2.3.4 8080 %h %p ~/.ssh/proxyauth

% cat ~/.ssh/proxyauth
username:password&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://sshmenu.sourceforge.net/articles/transparent-mulithop.html&#34;&gt;Transparent Multi-hop SSH&lt;/a&gt; &amp;ndash; using ProxyCommand and netcat to automate double ssh hops (also, my &lt;a href=&#34;http://www.mail-archive.com/slug@slug.org.au/msg62991.html&#34;&gt;SLUG question&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;non socks-ifiable programs can use socks via &lt;a href=&#34;http://tsocks.sourceforge.net/&#34;&gt;tsocks&lt;/a&gt;. This is really handy for getting &lt;strong&gt;apt&lt;/strong&gt; to work &amp;ndash; remember ssh is acting as a &lt;em&gt;socks&lt;/em&gt; proxy and not as an &lt;em&gt;http&lt;/em&gt; proxy. For example *sudo tsocks aptitude install foo&lt;br /&gt;
*&lt;/li&gt;
&lt;li&gt;lots of good tunnelling ideas on the &lt;a href=&#34;https://trac.torproject.org/projects/tor/wiki/TheOnionRouter/TorifyHOWTO/Misc&#34;&gt;Tor Wiki HOWTO&lt;/a&gt; and &lt;a href=&#34;http://fooninja.net/2010/09/06/how-to-tunnel-everything-through-ssh/&#34;&gt;How to tunnel everything through ssh&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;also secure your dns traffic by setting &lt;strong&gt;network.proxy.socks_remote_dns = true&lt;/strong&gt; in Firefox&amp;rsquo;s about:config&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://lbolla.wordpress.com/2008/04/21/cvs-behind-a-firewall-through-an-http-proxy/&#34;&gt;cvs + socks&lt;/a&gt; using connect.c (similar to my post on &lt;a href=&#34;http://blog.snowfrog.net/2007/12/04/svn-over-an-ssh-tunnel/&#34;&gt;svn over an ssh tunnel&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;another similar article &lt;a href=&#34;http://www.linux.com/articles/56945&#34;&gt;Secure your Wi-Fi traffic using FOSS utilities&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Jan/2011:&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;the &lt;a href=&#34;http://getfoxyproxy.org/&#34;&gt;FoxyProxy website&lt;/a&gt; has some good tutorials, and links to other material&lt;/li&gt;
&lt;li&gt;Linux Magazine has an article called &lt;a href=&#34;http://www.linux-mag.com/id/2062/&#34;&gt;Tunnelling Data&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;PaulDotCom &amp;ndash; &lt;a href=&#34;http://pauldotcom.com/2010/03/ssh-gymnastics-with-proxychain.html&#34;&gt;SSH gymnastics with proxychains&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;div id=&#34;_mcePaste&#34; class=&#34;mcePaste&#34; style=&#34;position:absolute;left:-10000px;top:0;width:1px;height:1px;overflow:hidden;&#34;&gt;
  &lt;pre&gt;&lt;code&gt;export http_proxy=&#39;http://219.93.2.113:3128/&#39;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
    </item>
    
  </channel>
</rss>